<!-- Floating Chat Button -->
<button id="ps-chat-button" aria-label="Open AI Support Assistant">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
  </svg>
  <div id="ps-chat-button-text">
    <div id="ps-chat-button-title">AI Support Assistant</div>
    <div id="ps-chat-button-desc">Ask me anything</div>
  </div>
</button>

<div id="ps-chat-modal" style="display: none;">
  <div id="ps-chat-modal-backdrop"></div>
  <div id="ps-chat-modal-container">
    <button id="ps-chat-close-button" aria-label="Close chat">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
    <iframe src="https://portable-spas-ai-chat.vercel.app" id="ps-chat-iframe" title="Portable Spas Chat Assistant" allow="clipboard-write"></iframe>
  </div>
</div>

<style>
#ps-chat-button{position:fixed;bottom:24px;right:24px;background:#1f2937;color:white;border:none;border-radius:50px;padding:16px 24px;display:flex;align-items:center;gap:10px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.15);transition:all 0.3s ease;z-index:999999;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:15px;font-weight:500}
#ps-chat-button:hover{background:#374151;box-shadow:0 6px 16px rgba(0,0,0,0.2);transform:translateY(-2px)}
#ps-chat-button svg{flex-shrink:0}
#ps-chat-button-text{display:flex;flex-direction:column;align-items:flex-start;gap:2px}
#ps-chat-button-title{font-size:15px;font-weight:600;line-height:1.2}
#ps-chat-button-desc{font-size:12px;font-weight:400;opacity:0.9;line-height:1.2}
@media (max-width:640px){#ps-chat-button{padding:16px;border-radius:50%}#ps-chat-button-text{display:none}}
#ps-chat-modal{position:fixed;top:0;left:0;right:0;bottom:0;z-index:999999;display:flex;isolation:isolate;align-items:center;justify-content:center;padding:16px}
#ps-chat-modal-backdrop{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);z-index:1}
#ps-chat-modal-container{position:relative;background:white;border-radius:16px;width:100%;max-width:900px;height:90vh;max-height:800px;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden;z-index:2}
#ps-chat-close-button{position:absolute;top:16px;right:16px;background:white;border:none;padding:8px;cursor:pointer;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#6b7280;transition:all 0.2s ease;z-index:10;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
#ps-chat-close-button:hover{background:#f3f4f6;color:#1f2937}
#ps-chat-iframe{flex:1;width:100%;border:none;display:block}
@media (max-width:640px){#ps-chat-modal{padding:0}#ps-chat-modal-container{border-radius:0;max-width:100%;height:100vh;max-height:100vh}}
@keyframes ps-fade-in{from{opacity:0}to{opacity:1}}
@keyframes ps-slide-up{from{opacity:0;transform:translateY(20px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}
body.ps-chat-modal-open{overflow:hidden}
#ps-chat-modal{animation:ps-fade-in 0.2s ease}
#ps-chat-modal-container{animation:ps-slide-up 0.3s ease}
</style>

<script type="text/javascript">
window.addEventListener('load',function(){setTimeout(function(){var b=document.getElementById('ps-chat-button'),m=document.getElementById('ps-chat-modal'),d=document.getElementById('ps-chat-modal-backdrop'),c=document.getElementById('ps-chat-close-button');if(!b||!m||!d||!c)return;b.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();m.style.display='flex';document.body.classList.add('ps-chat-modal-open')});function close(){m.style.display='none';document.body.classList.remove('ps-chat-modal-open')}c.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();close()});d.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();close()});document.addEventListener('keydown',function(e){if(e.key==='Escape'&&m.style.display==='flex')close()})},200)});
</script>
